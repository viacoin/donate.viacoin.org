<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">

    <title>Viacoin Ledger donation</title>

    <!-- Bootstrap core CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.7/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<!-- <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script> -->
    <!-- Custom styles for this template -->
<!--     <script>
        $(function() {
            $.ajax({
                dataType: "json",
                url: "https://blockexplorer.com/api/addr/1C3wt6mGgKVkaao6R6uuwMY3EtDGBwUVgo",
                success: function(data) {
                    var percentage = parseFloat(data.totalReceived / 5.44 * 100).toFixed(2);
                    $.ajax({
                        dataType: "json",
                        url: "https://api.blockcypher.com/v1/ltc/main/addrs/LXTyesP2C1egvHQjjeFEnLkVdesirpozW3",
                        success: function(data) {
                            var ltcpercentage = parseFloat(data.final_balance / 100000000 / 457.34 * 100).toFixed(2);
                            //                    $(".progress-bar").css('width', percentage+"%");
                            //                    $('.progress-bar').html(percentage+"%");
                            $.ajax({
                                url: "https://api.blockcypher.com/v1/dash/main/addrs/XwMX5wWQ9sef6syhJJDZgjAfBeTC5PVvEv",
                                success: function(data) {
                                    var dashpercentage = parseFloat(100 / 20000 * (data.final_balance / 100000000 * 356)).toFixed(2);
                                    var totalpercentage = (parseFloat(percentage) + parseFloat(ltcpercentage) + parseFloat(dashpercentage)).toFixed(2);
                                    $(".progress-bar").css('width', totalpercentage + "%");
                                    $('.progress-bar').html(totalpercentage + "%");
                                }
                            });
                        }
                    });
                }
            });
        });
    </script> -->
    <style>
      /*body {*/
        /*background-image: url("bg.jpg");*/
      /*}*/

      .large-font{
        font-size: 30px;
        text-align: center;
      }
      .progress{
        height:50px;
        text-align:center;
      }
      .progress-bar {
        padding:15px;
        height:50px;
        background-color:#323232;
      }
    </style>
  </head>

  <body>
    <div class="container" id="app">
    <br>
      <h1>Donation Progress</h1>
        <div class="progress">
          <div class="progress-bar progress-bar-striped active large-font" role="progressbar" aria-valuenow="0" aria-valuemin="100" aria-valuemax="100" v-bind:style="{ 'width':percentage+'%'}">

          </div>
        </div>
      <br>
      <div class="row marketing">
        <div class="col-lg-12">

        <div class="card">
  <h4 class="card-header">Viacoin fundraise</h4>
  <div class="card-body">
    <p class="card-title">Donation goal: {{ goalBTC }} BTC</p>
    <br>
    <p class="card-text">BTC: 1C3wt6mGgKVkaao6R6uuwMY3EtDGBwUVgo</p>
    <p class="card-text">Dash: XwMX5wWQ9sef6syhJJDZgjAfBeTC5PVvEv</p>
    <p class="card-text">ETH: 0xa8b317Fd4f13EE571fE0B2C9051c3c89Eb5B7B1c</p>
    <p class="card-text">LTC: LXTyesP2C1egvHQjjeFEnLkVdesirpozW3</p>
    <!-- <p class="card-text">STRAT: SZ6mFNiuVyvkCwz6PBQaJjGpn6KvPnZsHz</p>
    <p class="card-text">ZEC: t1Ntgd4u2HpZFUdsDqLietYGYmxxy1NorX8</p> -->
    <a href="https://viacoin.org" class="btn btn-primary">Visit the viacoin website</a>
  </div>
</div>
<br>
<pre>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

BTC: 1C3wt6mGgKVkaao6R6uuwMY3EtDGBwUVgo
Dash: XwMX5wWQ9sef6syhJJDZgjAfBeTC5PVvEv
ETH: 0xa8b317Fd4f13EE571fE0B2C9051c3c89Eb5B7B1c
LTC: LXTyesP2C1egvHQjjeFEnLkVdesirpozW3
STRAT: SZ6mFNiuVyvkCwz6PBQaJjGpn6KvPnZsHz
ZEC: t1Ntgd4u2HpZFUdsDqLietYGYmxxy1NorX8
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCAAdFiEE+1u6Oha8avDSoh1hP5I2jw0hogYFAlme8TcACgkQP5I2jw0h
ogaujQf/ToDYHlGLhVb/ba8VHKKT4Kf0BNhD4v6EM8SCjMcOq/DNIK+rReJp5H/g
RPJDYoFewxpLln/0exaL5T9O4vFicIvKIT799Z61iPOuPjyFNyf7mPR/bgY1buRI
j94v0/bj2owejVMm+Esu2I6IN9C4NSCseUA26c5PRLRdwCe6bABsOZYuYle0USVY
ui+vvEsk5tRrb6ljuiMwO/sKp8N8m0l5IRwW7QzPkRQmkicL41VE65tSTVWUxYtc
9bXbd/+ZHCsONj/1S8wcmk91ork4uADxFCbAAhroz96HXsz+TEgvn6wJbptYYlRQ
5Y50eYW6eM5zpioDIGQo6FGInUf+4w==
=QZWT
-----END PGP SIGNATURE-----
</pre>
<br>
        </div>
      </div>

      <footer class="footer">
        <p>&copy; Viacoin 2014 - 2019</p>
      </footer>

    </div> <!-- /container -->
  </body>
  <script type="text/javascript">
    const app = new Vue({
      el: '#app',
      data() {
        return {
          goalBTC: 0.3,
          totalBitcoinsRaised: 0,
          percentage: 0,
          bitcoinAddress: "1C3wt6mGgKVkaao6R6uuwMY3EtDGBwUVgo",
          dashAddress: "XwMX5wWQ9sef6syhJJDZgjAfBeTC5PVvEv",
          litecoinAddress: "LXTyesP2C1egvHQjjeFEnLkVdesirpozW3",
          ethereumAddress: "0xa8b317Fd4f13EE571fE0B2C9051c3c89Eb5B7B1c",
          bitcoinBalance: -1,
          dashBalance: -1,
          litecoinBalance: -1,
          ethereumBalance: -1,
        };
      },
      mounted: function() {
        this.getBitcoinBalance(this.getFundsRaisedInBTC)
        //this.getFundsRaisedInBTC(this.getBitcoinBalance)
      },
      methods: {

        getBitcoinBalance: function(callback) {
          console.log("getting btc balance")
          axios.get('https://insight.bitpay.com/api/addr/'+this.bitcoinAddress)
          .then(response =>  {
            this.bitcoinBalance = response.data.totalReceived;
            callback();
          }).catch(error => {
            console.log(error)
          })

          axios.get('https://insight.dash.org/insight-api/addr/'+this.dashAddress)
                  .then(response =>  {
                    this.dashBalance = response.data.totalReceived;
                    callback();
                  }).catch(error => {
            console.log(error)
          })

          axios.get('https://insight.litecore.io/api/addr/'+this.litecoinAddress)
                  .then(response =>  {
                    this.litecoinBalance = response.data.totalReceived;
                    callback();
                  }).catch(error => {
            console.log(error)
          })


          axios.get('https://api.etherscan.io/api?module=account&action=balance&address='+this.ethereumAddress)
                  .then(response =>  {
                    this.ethereumBalance = response.data.result / 1000000000000000000;
                    callback();
                  }).catch(error => {
            console.log(error)
          })

          // await those 4 calls to end
          
          //this.getFundsRaisedInBTC()
        },

        getFundsRaisedInBTC: function() {
          if (this.bitcoinBalance >= 0 && this.dashBalance >= 0 && this.litecoinBalance >= 0 && this.ethereumBalance >= 0) {
            return; // only the last call when balances are set will go through
          }

          axios.get('https://www.worldcoinindex.com/apiservice/ticker?key=TMVEUGZjmAKnIgFg1gmJx7SVk&label=dashbtc-ltcbtc-ethbtc&fiat=btc')
          .then(response => {
            markets = response.data.Markets
            this.totalBitcoinsRaised = this.bitcoinBalance
            this.totalBitcoinsRaised += markets[0].Price * this.dashBalance
            this.totalBitcoinsRaised += markets[1].Price * this.litecoinBalance
            this.totalBitcoinsRaised += markets[2].Price * this.ethereumBalance
            this.percentage = (this.totalBitcoinsRaised * this.goalBTC) * 100
          }).catch(error => {
            console.log(error)
          })
        },
      }
    });
  </script>
</html>

<3